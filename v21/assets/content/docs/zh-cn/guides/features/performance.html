<p>在处理大规模任务数据时，<code>ngx-gantt</code> 通过 <strong>列表虚拟滚动</strong> 和 <strong>视图滚动加载</strong> 来保证流畅的交互体验。</p>

        <h2 id="%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6" class="docs-header-link">
          <span header-link="%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6"></span>
          核心机制
        </h2>
      <ul>
<li><strong>列表虚拟滚动</strong>：仅渲染当前视口内可见的任务行，即使有数千条数据，实际渲染的 DOM 节点也保持在极小数量级。</li>
<li><strong>视图滚动加载</strong>：通过配置时间轴边界和步长，实现在时间轴滚动到边缘时自动按需加载时间区间。</li>
</ul>

        <h2 id="%E5%88%97%E8%A1%A8%E8%99%9A%E6%8B%9F%E6%BB%9A%E5%8A%A8" class="docs-header-link">
          <span header-link="%E5%88%97%E8%A1%A8%E8%99%9A%E6%8B%9F%E6%BB%9A%E5%8A%A8"></span>
          列表虚拟滚动
        </h2>
      <p>甘特图通过虚拟滚动支持大数据量列表，组件默认开启了虚拟滚动。</p>
<pre class="language-html"><code class="language-html"><div><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ngx-gantt</span> <span class="token attr-name">[virtualScrollEnabled]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ngx-gantt</span><span class="token punctuation">></span></span></div></code></pre>

        <h3 id="%E7%A4%BA%E4%BE%8B%EF%BC%9A%E6%BB%9A%E5%8A%A8%E5%88%B0%E5%BA%95%E9%83%A8%E5%8A%A0%E8%BD%BD%E4%B8%8B%E4%B8%80%E9%A1%B5%E6%95%B0%E6%8D%AE" class="docs-header-link">
          <span header-link="%E7%A4%BA%E4%BE%8B%EF%BC%9A%E6%BB%9A%E5%8A%A8%E5%88%B0%E5%BA%95%E9%83%A8%E5%8A%A0%E8%BD%BD%E4%B8%8B%E4%B8%80%E9%A1%B5%E6%95%B0%E6%8D%AE"></span>
          示例：滚动到底部加载下一页数据
        </h3>
      <p>当服务端没有通过一次将数据全量返回时，也可以通过监听 <code>(virtualScrolledIndexChange)</code> 事件，在滚动接近底部时实现无限加载（Infinite Scroll）。</p>
<pre class="language-html"><code class="language-html"><div><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ngx-gantt</span> <span class="token attr-name">[items]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>items<span class="token punctuation">"</span></span> <span class="token attr-name">[loading]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>loading<span class="token punctuation">"</span></span> <span class="token attr-name">[loadingDelay]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">(virtualScrolledIndexChange)</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>onVirtualScroll($event)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ngx-gantt-table</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ngx-gantt-column</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>任务标题<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200px<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ng-template</span> <span class="token attr-name">#cell</span> <span class="token attr-name">let-item</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>{{ item.title }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ng-template</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ngx-gantt-column</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ngx-gantt-table</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ngx-gantt</span><span class="token punctuation">></span></span></div></code></pre>
<pre class="language-ts"><code class="language-ts"><div><span class="token keyword">import</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> GanttItem<span class="token punctuation">,</span> GanttVirtualScrolledIndexChangeEvent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@worktile/gantt'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">GanttPerformanceExampleComponent</span> <span class="token punctuation">{</span>
  items<span class="token punctuation">:</span> GanttItem<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  loading <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>

  <span class="token function">onVirtualScroll</span><span class="token punctuation">(</span>event<span class="token punctuation">:</span> GanttVirtualScrolledIndexChangeEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 当滚动到距离底部还剩 10 条数据时，加载下一页</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>renderedRange<span class="token punctuation">.</span>end <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">>=</span> event<span class="token punctuation">.</span>count <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>loading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadNextPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">loadNextPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>taskService<span class="token punctuation">.</span><span class="token function">getTasks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>res <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">,</span> <span class="token operator">...</span>res<span class="token punctuation">.</span>data<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></div></code></pre>

        <h2 id="%E8%A7%86%E5%9B%BE%E6%BB%9A%E5%8A%A8%E5%8A%A0%E8%BD%BD" class="docs-header-link">
          <span header-link="%E8%A7%86%E5%9B%BE%E6%BB%9A%E5%8A%A8%E5%8A%A0%E8%BD%BD"></span>
          视图滚动加载
        </h2>
      <p>组件默认情况下滚动加载是禁用的，当甘特图的时间跨度非常大时，一次性加载所有时间轴数据会影响性能，可通过参数 <code>disabledLoadOnScroll</code> 设置 <code>false</code> 来启用，启用后当滚动到视图边界时，会触发视图滚动加载。</p>
<pre class="language-html"><code class="language-html"><div><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ngx-gantt</span> <span class="token attr-name">[disabledLoadOnScroll]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ngx-gantt</span><span class="token punctuation">></span></span></div></code></pre>

        <h3 id="%E6%BB%9A%E5%8A%A8%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6" class="docs-header-link">
          <span header-link="%E6%BB%9A%E5%8A%A8%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6"></span>
          滚动加载机制
        </h3>
      <p>根据不同的视图类型，滚动加载的时间跨度（步长）会自动调整，例如：</p>
<ul>
<li>日视图 (Day)：默认单次扩展 1 个月。</li>
<li>月视图 (Month)：默认单次扩展 1 个季度。</li>
</ul>
<p>你可以通过 <code>viewOptions</code> 中的 <code>loadDuration</code> 自定义这个步长，并通过 <code>minBoundary</code> 和 <code>maxBoundary</code> 限制时间轴的最大范围（默认限制在当前年份的前后一年）。</p>

        <h3 id="%E7%A4%BA%E4%BE%8B%EF%BC%9A%E8%A7%86%E5%9B%BE%E6%BB%9A%E5%8A%A8%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE" class="docs-header-link">
          <span header-link="%E7%A4%BA%E4%BE%8B%EF%BC%9A%E8%A7%86%E5%9B%BE%E6%BB%9A%E5%8A%A8%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE"></span>
          示例：视图滚动加载数据
        </h3>
      <p>开启滚动加载后，当用户将时间轴拖动到边缘时，会触发 <code>(loadOnScroll)</code> 事件，此时可以根据返回的新区间请求数据。</p>
<pre class="language-html"><code class="language-html"><div><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ngx-gantt</span>
  <span class="token attr-name">[items]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>items<span class="token punctuation">"</span></span>
  <span class="token attr-name">[loading]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>loading<span class="token punctuation">"</span></span>
  <span class="token attr-name">[loadingDelay]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span>
  <span class="token attr-name">[disabledLoadOnScroll]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span>
  <span class="token attr-name">[viewOptions]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{
    loadDuration: { amount: 1, unit: <span class="token punctuation">'</span>month<span class="token punctuation">'</span> },
    minBoundary: minDate,
    maxBoundary: maxDate
  }<span class="token punctuation">"</span></span>
  <span class="token attr-name">(loadOnScroll)</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>onLoadOnScroll($event)<span class="token punctuation">"</span></span>
<span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ngx-gantt</span><span class="token punctuation">></span></span></div></code></pre>
<pre class="language-ts"><code class="language-ts"><div><span class="token keyword">import</span> <span class="token punctuation">{</span> GanttLoadOnScrollEvent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@worktile/gantt'</span><span class="token punctuation">;</span>

<span class="token function">onLoadOnScroll</span><span class="token punctuation">(</span>event<span class="token punctuation">:</span> GanttLoadOnScrollEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// event.start 和 event.end 是新增的时间范围（Unix 时间戳）</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>taskService<span class="token punctuation">.</span><span class="token function">getTasksByRange</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>start<span class="token punctuation">,</span> event<span class="token punctuation">.</span>end<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>newItems <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">,</span> <span class="token operator">...</span>newItems<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></div></code></pre>

        <h2 id="%E5%8A%A0%E8%BD%BD%E7%8A%B6%E6%80%81%E5%A4%84%E7%90%86" class="docs-header-link">
          <span header-link="%E5%8A%A0%E8%BD%BD%E7%8A%B6%E6%80%81%E5%A4%84%E7%90%86"></span>
          加载状态处理
        </h2>
      <p>在异步加载数据时，良好的加载反馈能提升用户体验。<code>ngx-gantt</code> 提供了内置的加载器（Loader）：</p>
<ul>
<li><strong><code>loading</code></strong>: 设置为 <code>true</code> 时展示加载状态。</li>
<li><strong><code>loadingDelay</code></strong>: 设置加载状态显示的延迟时间（单位：<code>ms</code>）。当数据请求在极短时间内（小于延迟时间）返回时，加载器将不会显示，从而有效避免因网络较快导致的加载动画瞬间闪烁。</li>
</ul>

        <h2 id="%E7%9B%B8%E5%85%B3%E9%93%BE%E6%8E%A5" class="docs-header-link">
          <span header-link="%E7%9B%B8%E5%85%B3%E9%93%BE%E6%8E%A5"></span>
          相关链接
        </h2>
      <ul>
<li><a href="guides/core-concepts/views">视图</a> - 了解视图类型及其配置选项</li>
</ul>
